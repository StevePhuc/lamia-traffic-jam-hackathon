<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="theme-color" content="#000000" />
        <meta name="description" content="Web site created using create-react-app" />
        <link rel="apple-touch-icon" href="logo192.png" />
        <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
        <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
        <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/favicon.ico" or "favicon.ico", "%PUBLIC_URL%/favicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
        <link
            rel="stylesheet"
            href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
            integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
            crossorigin=""
        />
        <script
            src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
            integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
            crossorigin=""
        ></script>
        <style>
            #issMap {
                height: 300px;
            }
        </style>

        <title>Lamia Traffic Jam</title>
    </head>
    <body>
        <noscript>You need to enable JavaScript to run this app.</noscript>
        <div id="root"></div>

        <h1>Tram Jam project - Lamia Flow HSL Hackathon</h1>
        <p>
            Tram Jam project, in which the broad idea is to estimate tram congestion (ie. how full
            of people a tram is) based on tram stop times and other real-time data.
        </p>

        <div id="issMap"></div>

        <script>
            // Making a map and tiles
            // Setting a higher initial zoom to make effect more obvious
            const mymap = L.map("issMap").setView([0, 0], 6);
            const attribution =
                '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';
            const tileUrl = "https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png";
            const tiles = L.tileLayer(tileUrl, { attribution });
            tiles.addTo(mymap);
            // Making a marker with a custom icon
            const issIcon = L.icon({
                iconUrl: "iss200.png",
                iconSize: [50, 32],
                iconAnchor: [25, 16]
            });
            let marker = L.marker([0, 0], { icon: issIcon }).addTo(mymap);
            const api_url = "https://api.wheretheiss.at/v1/satellites/25544";
            let firstTime = true;
            async function getISS() {
                const response = await fetch(api_url);
                const data = await response.json();
                const { latitude, longitude } = data;
                // Always set the view to current lat lon and zoom!
                mymap.setView([latitude, longitude], mymap.getZoom());
                marker.setLatLng([latitude, longitude]);
            }
            getISS();
            setInterval(getISS, 5000);
        </script>
    </body>
</html>
